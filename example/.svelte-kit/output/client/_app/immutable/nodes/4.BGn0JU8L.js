import{f as T,a as v,b as g,c as M,i as H}from"../chunks/CDtJAJDW.js";import"../chunks/CdqBHIUe.js";import{m as de,o as ce,t as te,u as le,v as se,w as ue,x as r,y as pe,z as me,p as ve,c as fe,d as ge,A as t,B as s,$ as be,D as e,F as P,f as E}from"../chunks/43DoFiGK.js";import{e as R,i as w}from"../chunks/B5-rS708.js";import{h as he}from"../chunks/D3R2J86X.js";import{C as k}from"../chunks/BgxKhnFH.js";function ke(S=!1){const b=de,f=b.l.u;if(!f)return;let C=()=>pe(b.s);if(S){let I=0,y={};const N=me(()=>{let D=!1;const A=b.s;for(const h in A)A[h]!==y[h]&&(y[h]=A[h],D=!0);return D&&I++,I});C=()=>r(N)}f.b.length&&ce(()=>{ae(b,C),se(f.b)}),te(()=>{const I=le(()=>f.m.map(ue));return()=>{for(const y of I)typeof y=="function"&&y()}}),f.a.length&&te(()=>{ae(b,C),se(f.a)})}function ae(S,b){if(S.l.s)for(const f of S.l.s)r(f);b()}const J=[{name:"constructor",signature:"new ReliableScheduler(storage: DurableObjectStorage)",description:"Creates a new scheduler instance with the provided Durable Object storage.",type:"constructor"},{name:"generateTaskId",signature:'static generateTaskId(prefix: string = "task"): string',description:"Generate a unique task ID. Default prefix is 'task'.",type:"static"},{name:"alarm",signature:"async alarm(): Promise<void>",description:"Call this from your Durable Object's alarm handler to process scheduled tasks.",type:"method"},{name:"cancelTask",signature:"async cancelTask(taskId: string): Promise<boolean>",description:"Cancel and delete a task. Returns true if successful, false if task not found.",type:"method"},{name:"checkpoint",signature:"async checkpoint(taskId: string, key: string, value: unknown): Promise<void>",description:"Save progress for a task. Use this to mark completion of expensive operations.",type:"method"},{name:"clearAll",signature:"async clearAll(): Promise<number>",description:"Delete all tasks regardless of status. Returns the count of deleted tasks.",type:"method"},{name:"clearCompleted",signature:"async clearCompleted(): Promise<number>",description:"Delete all completed tasks. Returns the count of deleted tasks.",type:"method"},{name:"completeTask",signature:"async completeTask(taskId: string): Promise<void>",description:"Mark a task as complete and clean up its state.",type:"method"},{name:"formatTaskForUI",signature:"formatTaskForUI(task: Task): any",description:"Format a task object for UI consumption with standardized fields.",type:"method"},{name:"getCheckpoint",signature:"async getCheckpoint(taskId: string, key: string): Promise<unknown>",description:"Retrieve saved progress for a task. Returns undefined if not found.",type:"method"},{name:"getHandler",signature:"getHandler(taskName: string): TaskHandler | undefined",description:"Get a registered handler by name. Returns undefined if not found.",type:"method"},{name:"getTask",signature:"async getTask(taskId: string): Promise<Task | undefined>",description:"Get a single task by ID. Returns undefined if not found.",type:"method"},{name:"getTasks",signature:"async getTasks(status?: TaskStatus): Promise<Task[]>",description:"Get all tasks, optionally filtered by status.",type:"method"},{name:"pauseTask",signature:"async pauseTask(taskId: string): Promise<boolean>",description:"Pause a running task. Returns true if successful, false if task not found or cannot be paused.",type:"method"},{name:"register",signature:"register(taskName: string, handler: TaskHandler): void",description:"Register a named task handler. The handler receives the scheduler, taskId, and params.",type:"method"},{name:"resumeTask",signature:"async resumeTask(taskId: string): Promise<boolean>",description:"Resume a paused task. Returns true if successful, false if task not found or not paused.",type:"method"},{name:"runNow",signature:"async runNow((): Promise<void>",description:"Start a task immediately with eviction safety. Sets a 30s safety alarm for automatic retry. @param options.maxRetries - Override default retry count (default: 3, use Infinity for infinite loop tasks)",type:"method"},{name:"runSteps",signature:"async runSteps((): Promise<void>",description:"Execute a multi-step task with automatic progress tracking, pause/resume support, checkpointing, and optional auto-completion.",type:"method"},{name:"runSubSteps",signature:"async runSubSteps(taskId: string, stepName: string, stepIndex: number, totalSteps: number, subStepCount: number, subStepDuration: number, onSubStep?: (subStepIndex: number) => Promise<void> | Effect.Effect<void>): Promise<void>",description:"Helper for sub-step execution within a step. Handles pause checks and progress tracking automatically.",type:"method"},{name:"schedule",signature:"async schedule((): Promise<void>",description:"Schedule a task to run at a future time (Unix timestamp or Date).",type:"method"}];var ye=T('<div><!> <p class="mt-3 text-muted-foreground"> </p></div>'),xe=T('<div><!> <p class="mt-3 text-muted-foreground"> </p></div>'),_e=T('<div><h3 class="font-mono text-lg font-semibold text-primary mb-2"> </h3> <!> <p class="mt-3 text-muted-foreground"> </p></div>'),Te=T('<div><h3 class="font-mono text-lg font-semibold text-primary mb-2"> </h3> <!> <p class="mt-3 text-muted-foreground"> </p></div>'),Se=T('<div><h3 class="font-mono text-lg font-semibold text-primary mb-2"> </h3> <!> <p class="mt-3 text-muted-foreground"> </p></div>'),Ie=T('<div><h3 class="font-mono text-lg font-semibold text-primary mb-2"> </h3> <!> <p class="mt-3 text-muted-foreground"> </p></div>'),Pe=T('<div class="min-h-screen bg-gradient-to-b from-background to-muted/20"><div class="container mx-auto px-6 py-16 max-w-5xl"><div class="mb-12"><h1 class="text-4xl font-bold mb-4 tracking-tight">API Reference</h1> <p class="text-xl text-muted-foreground">Complete API documentation for the ReliableScheduler class.</p></div> <nav class="mb-12 p-4 rounded-xl bg-muted/50 border"><div class="flex flex-wrap gap-2 text-sm"><a href="#constructor" class="px-3 py-1.5 rounded-lg hover:bg-muted transition-colors">Constructor</a> <a href="#static" class="px-3 py-1.5 rounded-lg hover:bg-muted transition-colors">Static Methods</a> <a href="#core" class="px-3 py-1.5 rounded-lg hover:bg-muted transition-colors">Core Execution</a> <a href="#management" class="px-3 py-1.5 rounded-lg hover:bg-muted transition-colors">Task Management</a> <a href="#progress" class="px-3 py-1.5 rounded-lg hover:bg-muted transition-colors">Progress & Steps</a> <a href="#utilities" class="px-3 py-1.5 rounded-lg hover:bg-muted transition-colors">Utilities</a></div></nav> <section id="constructor" class="mb-12"><h2 class="text-2xl font-semibold mb-6 pb-2 border-b">Constructor</h2> <!></section> <section id="static" class="mb-12"><h2 class="text-2xl font-semibold mb-6 pb-2 border-b">Static Methods</h2> <div class="space-y-6"></div></section> <section id="core" class="mb-12"><h2 class="text-2xl font-semibold mb-6 pb-2 border-b">Core Execution</h2> <div class="space-y-6"></div></section> <section id="management" class="mb-12"><h2 class="text-2xl font-semibold mb-6 pb-2 border-b">Task Management</h2> <div class="space-y-6"></div></section> <section id="progress" class="mb-12"><h2 class="text-2xl font-semibold mb-6 pb-2 border-b">Progress & Steps</h2> <div class="space-y-6"></div></section> <section id="utilities" class="mb-12"><h2 class="text-2xl font-semibold mb-6 pb-2 border-b">Utilities</h2> <div class="space-y-6"></div></section> <section id="types" class="mb-12"><h2 class="text-2xl font-semibold mb-6 pb-2 border-b">Types</h2> <div class="space-y-6"><div><h3 class="font-mono text-lg font-semibold text-primary mb-2">TaskStatus</h3> <!></div> <div><h3 class="font-mono text-lg font-semibold text-primary mb-2">Task</h3> <!></div> <div><h3 class="font-mono text-lg font-semibold text-primary mb-2">TaskHandler</h3> <!></div></div></section></div></div>');function He(S,b){ve(b,!1);const f=J.filter(o=>o.type==="constructor"),C=J.filter(o=>o.type==="static"),I=J.filter(o=>o.type==="method"),y=["runNow","schedule","alarm","register"],N=["getTask","getTasks","cancelTask","pauseTask","resumeTask","completeTask"],D=["checkpoint","getCheckpoint","runSteps","runSubSteps"],A=["clearCompleted","clearAll","formatTaskForUI","getHandler"];function h(o){return o.map(a=>I.find(n=>n.name===a)).filter(Boolean)}ke();var U=Pe();he("1c8t0id",o=>{ge(()=>{be.title="API Reference - ironalarm"})});var K=s(U),$=t(s(K),4),re=t(s($),2);R(re,1,()=>f,w,(o,a)=>{var n=ye(),l=s(n);k(l,{get code(){return r(a).signature},lang:"typescript"});var u=t(l,2),i=s(u,!0);e(u),e(n),P(()=>g(i,r(a).description)),v(o,n)}),e($);var F=t($,2),L=t(s(F),2);R(L,5,()=>C,w,(o,a)=>{var n=xe(),l=s(n);k(l,{get code(){return r(a).signature},lang:"typescript"});var u=t(l,2),i=s(u,!0);e(u),e(n),P(()=>g(i,r(a).description)),v(o,n)}),e(L),e(F);var O=t(F,2),Q=t(s(O),2);R(Q,5,()=>h(y),w,(o,a)=>{var n=M(),l=E(n);{var u=i=>{var d=_e(),c=s(d),x=s(c);e(c);var p=t(c,2);k(p,{get code(){return r(a).signature},lang:"typescript"});var m=t(p,2),_=s(m,!0);e(m),e(d),P(()=>{g(x,`${r(a).name??""}()`),g(_,r(a).description)}),v(i,d)};H(l,i=>{r(a)&&i(u)})}v(o,n)}),e(Q),e(O);var j=t(O,2),V=t(s(j),2);R(V,5,()=>h(N),w,(o,a)=>{var n=M(),l=E(n);{var u=i=>{var d=Te(),c=s(d),x=s(c);e(c);var p=t(c,2);k(p,{get code(){return r(a).signature},lang:"typescript"});var m=t(p,2),_=s(m,!0);e(m),e(d),P(()=>{g(x,`${r(a).name??""}()`),g(_,r(a).description)}),v(i,d)};H(l,i=>{r(a)&&i(u)})}v(o,n)}),e(V),e(j);var B=t(j,2),W=t(s(B),2);R(W,5,()=>h(D),w,(o,a)=>{var n=M(),l=E(n);{var u=i=>{var d=Se(),c=s(d),x=s(c);e(c);var p=t(c,2);k(p,{get code(){return r(a).signature},lang:"typescript"});var m=t(p,2),_=s(m,!0);e(m),e(d),P(()=>{g(x,`${r(a).name??""}()`),g(_,r(a).description)}),v(i,d)};H(l,i=>{r(a)&&i(u)})}v(o,n)}),e(W),e(B);var G=t(B,2),X=t(s(G),2);R(X,5,()=>h(A),w,(o,a)=>{var n=M(),l=E(n);{var u=i=>{var d=Ie(),c=s(d),x=s(c);e(c);var p=t(c,2);k(p,{get code(){return r(a).signature},lang:"typescript"});var m=t(p,2),_=s(m,!0);e(m),e(d),P(()=>{g(x,`${r(a).name??""}()`),g(_,r(a).description)}),v(i,d)};H(l,i=>{r(a)&&i(u)})}v(o,n)}),e(X),e(G);var Y=t(G,2),Z=t(s(Y),2),z=s(Z),ne=t(s(z),2);k(ne,{code:'type TaskStatus = "pending" | "running" | "paused" | "completed" | "failed"',lang:"typescript"}),e(z);var q=t(z,2),oe=t(s(q),2);k(oe,{code:`interface Task {
  taskId: string;
  taskName: string;
  params: unknown;
  scheduledAt: number;
  startedAt: number;
  status: TaskStatus;
  safetyAlarmAt?: number;
  progress: Record<string, unknown>;
  retryCount?: number;
  maxRetries?: number;
  pausedAt?: number;
}`,lang:"typescript"}),e(q);var ee=t(q,2),ie=t(s(ee),2);k(ie,{code:`type TaskHandler = (
  scheduler: ReliableScheduler,
  taskId: string,
  params: unknown
) => Effect.Effect<void>`,lang:"typescript"}),e(ee),e(Z),e(Y),e(K),e(U),v(S,U),fe()}export{He as component};
